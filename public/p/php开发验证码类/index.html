<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PHP开发验证码类 | Archai&#39;s home</title>
<meta name="keywords" content="PHP" />
<meta name="description" content="利用php中的GD库可以完成验证码类的开发。后盾人教程
 PHP创建图像步骤 发送HTTP头信息，声明内容为图像 1 2 3  header(&#39;Content-type:image/gif&#39;); header(&#39;Content-type:image/jpeg&#39;); header(&#39;Content-type:image/png&#39;);   通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型
创建画布 1  imageCreateTrueColor(width,height);   width &amp; height 画布宽高，即为输出图片的尺寸,返回为source 类型，后续操作都是针对这个资源展开。
创建绘图所需要的颜色 1  imageColorAllocate(img_resource,R,G,B);   颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为int类型,在0—255之间。
绘图（填充画布、画圆、画方块、画线条、画布上写字） 👉 填充画布(画布背景)
1  imageFill(img_resource,x,y,color);   👉 画圆
1 2 3 4  //绘制空心圆形 imageEllipse(img_res,x,y,w,h,color); //绘制填充好的实心圆 imageFilledEllipse(img_res,x,y,w,h,color);   绘制 圆心(x,y) 宽 x，高 h，的圆
👉 画方
1 2 3 4  //空心矩形 imageRectangle(img_res,x1,y1,x2,y2,color); //实心矩形 imageFilledRectangle (img_res,x1,y1,x2,y2,color);   (x1,y1)为左上角坐标， (x2,y2)为右下角坐标">
<meta name="author" content="Archai">
<link rel="canonical" href="https://www.fintinger.site/p/php%E5%BC%80%E5%8F%91%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.4ee57c4189977dc8f075173100c24a668d6bb09d6b5db74440649223f1221877.css" integrity="sha256-TuV8QYmXfcjwdRcxAMJKZo1rsJ1rXbdEQGSSI/EiGHc=" rel="preload stylesheet" as="style">
<link rel="stylesheet" href="css/extended/custom.css">
<link rel="icon" href="https://gitee.com/fintinger/figure-bed/raw/master//images/20210530080206.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://gitee.com/fintinger/figure-bed/raw/master//images/20210530080206.ico">
<link rel="icon" type="image/png" sizes="32x32" href="https://gitee.com/fintinger/figure-bed/raw/master//images/20210530080206.ico">
<link rel="apple-touch-icon" href="https://www.fintinger.site/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.fintinger.site/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="PHP开发验证码类" />
<meta property="og:description" content="利用php中的GD库可以完成验证码类的开发。后盾人教程
 PHP创建图像步骤 发送HTTP头信息，声明内容为图像 1 2 3  header(&#39;Content-type:image/gif&#39;); header(&#39;Content-type:image/jpeg&#39;); header(&#39;Content-type:image/png&#39;);   通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型
创建画布 1  imageCreateTrueColor(width,height);   width &amp; height 画布宽高，即为输出图片的尺寸,返回为source 类型，后续操作都是针对这个资源展开。
创建绘图所需要的颜色 1  imageColorAllocate(img_resource,R,G,B);   颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为int类型,在0—255之间。
绘图（填充画布、画圆、画方块、画线条、画布上写字） 👉 填充画布(画布背景)
1  imageFill(img_resource,x,y,color);   👉 画圆
1 2 3 4  //绘制空心圆形 imageEllipse(img_res,x,y,w,h,color); //绘制填充好的实心圆 imageFilledEllipse(img_res,x,y,w,h,color);   绘制 圆心(x,y) 宽 x，高 h，的圆
👉 画方
1 2 3 4  //空心矩形 imageRectangle(img_res,x1,y1,x2,y2,color); //实心矩形 imageFilledRectangle (img_res,x1,y1,x2,y2,color);   (x1,y1)为左上角坐标， (x2,y2)为右下角坐标" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.fintinger.site/p/php%E5%BC%80%E5%8F%91%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB/" /><meta property="og:image" content="https://gitee.com/fintinger/figure-bed/raw/master//images/20210803221048.jpeg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-03T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2020-10-03T00:00:00&#43;00:00" /><meta property="og:site_name" content="Archai&#39;s home" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://gitee.com/fintinger/figure-bed/raw/master//images/20210803221048.jpeg"/>

<meta name="twitter:title" content="PHP开发验证码类"/>
<meta name="twitter:description" content="利用php中的GD库可以完成验证码类的开发。后盾人教程
 PHP创建图像步骤 发送HTTP头信息，声明内容为图像 1 2 3  header(&#39;Content-type:image/gif&#39;); header(&#39;Content-type:image/jpeg&#39;); header(&#39;Content-type:image/png&#39;);   通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型
创建画布 1  imageCreateTrueColor(width,height);   width &amp; height 画布宽高，即为输出图片的尺寸,返回为source 类型，后续操作都是针对这个资源展开。
创建绘图所需要的颜色 1  imageColorAllocate(img_resource,R,G,B);   颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为int类型,在0—255之间。
绘图（填充画布、画圆、画方块、画线条、画布上写字） 👉 填充画布(画布背景)
1  imageFill(img_resource,x,y,color);   👉 画圆
1 2 3 4  //绘制空心圆形 imageEllipse(img_res,x,y,w,h,color); //绘制填充好的实心圆 imageFilledEllipse(img_res,x,y,w,h,color);   绘制 圆心(x,y) 宽 x，高 h，的圆
👉 画方
1 2 3 4  //空心矩形 imageRectangle(img_res,x1,y1,x2,y2,color); //实心矩形 imageFilledRectangle (img_res,x1,y1,x2,y2,color);   (x1,y1)为左上角坐标， (x2,y2)为右下角坐标"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://www.fintinger.site/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "PHP开发验证码类",
      "item": "https://www.fintinger.site/p/php%E5%BC%80%E5%8F%91%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PHP开发验证码类",
  "name": "PHP开发验证码类",
  "description": "利用php中的GD库可以完成验证码类的开发。后盾人教程\n PHP创建图像步骤 发送HTTP头信息，声明内容为图像 1 2 3  header(\u0026#39;Content-type:image/gif\u0026#39;); header(\u0026#39;Content-type:image/jpeg\u0026#39;); header(\u0026#39;Content-type:image/png\u0026#39;);   通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型\n创建画布 1  imageCreateTrueColor(width,height);   width \u0026amp; height 画布宽高，即为输出图片的尺寸,返回为source 类型，后续操作都是针对这个资源展开。\n创建绘图所需要的颜色 1  imageColorAllocate(img_resource,R,G,B);   颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为int类型,在0—255之间。\n绘图（填充画布、画圆、画方块、画线条、画布上写字） 👉 填充画布(画布背景)\n1  imageFill(img_resource,x,y,color);   👉 画圆\n1 2 3 4  //绘制空心圆形 imageEllipse(img_res,x,y,w,h,color); //绘制填充好的实心圆 imageFilledEllipse(img_res,x,y,w,h,color);   绘制 圆心(x,y) 宽 x，高 h，的圆\n👉 画方\n1 2 3 4  //空心矩形 imageRectangle(img_res,x1,y1,x2,y2,color); //实心矩形 imageFilledRectangle (img_res,x1,y1,x2,y2,color);   (x1,y1)为左上角坐标， (x2,y2)为右下角坐标",
  "keywords": [
    "PHP"
  ],
  "articleBody": " 利用php中的GD库可以完成验证码类的开发。后盾人教程\n PHP创建图像步骤 发送HTTP头信息，声明内容为图像 1 2 3  header('Content-type:image/gif'); header('Content-type:image/jpeg'); header('Content-type:image/png');   通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型\n创建画布 1  imageCreateTrueColor(width,height);   width \u0026 height 画布宽高，即为输出图片的尺寸,返回为source 类型，后续操作都是针对这个资源展开。\n创建绘图所需要的颜色 1  imageColorAllocate(img_resource,R,G,B);   颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为int类型,在0—255之间。\n绘图（填充画布、画圆、画方块、画线条、画布上写字） 👉 填充画布(画布背景)\n1  imageFill(img_resource,x,y,color);   👉 画圆\n1 2 3 4  //绘制空心圆形 imageEllipse(img_res,x,y,w,h,color); //绘制填充好的实心圆 imageFilledEllipse(img_res,x,y,w,h,color);   绘制 圆心(x,y) 宽 x，高 h，的圆\n👉 画方\n1 2 3 4  //空心矩形 imageRectangle(img_res,x1,y1,x2,y2,color); //实心矩形 imageFilledRectangle (img_res,x1,y1,x2,y2,color);   (x1,y1)为左上角坐标， (x2,y2)为右下角坐标\n👉画线条\nimageLine(img_res,x1,y1,x2,y2,color)\r(x1,y1)与(x2,y2)两点确定的直线。\n👉 绘制像素(点)\n1  imagesetpixel ( img_res , x , y , color )   👉 输入文本\n1  imagettftext (img_res , size , angle , x , y , color , fontfile ,text )   图像资源，字体尺寸，角度，第一个字符的基本点（大概是字符的左下角），Y 坐标（字体基线的位置），颜色 ，字体文件绝对路径(realpath($path)获取)，文本字符串（UTF-8 编码）\n ✨文本盒子？\n 1  imagettfbbox ( size , angle , fontfile , text );   返回一个含有 8 个单元的数组表示了文本外框的四个角，得到文本范围的盒子大小，可以方便控制文本输出位置：\n   变量 位置     0 左下角 X 位置   1 左下角 Y 位置   2 右下角 X 位置   3 右下角 Y 位置   4 右上角 X 位置   5 右上角 Y 位置   6 左上角 X 位置   7 左上角 Y 位置    输出图像 1 2 3 4  imagegif(img_resource[,filename]); imagejpeg(img_resource[,filename]); imagepng(img_resource[,filename]); imagebmp(img_resource[,filename]);   当设置第二个参数时表示储存文件，如果存在同名文件会覆盖\n释放画布资源 1  imageDestroy(img_resource);   图像输出完毕及时释放资源，把内存空间留给更需要的程序。\n验证码类 Verificationcode类  绘制画布，设置背景色，先写入随机文本，然后绘制随机干扰线，干扰点就可\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133  php class Verificationcode { protected $width; protected $height; protected $len; public $imgsource; protected $size; protected $fontfile; protected $rescode; public function __construct($w = 200, $h = 50, $len = 4, $size = null) { $this-width = $w; $this-height = $h; $this-len = $len; $this-size = is_null($size) ? $h * 0.4 : $size; $this-fontfile = realpath(\"source.ttf\"); } public function render() { $this-bg(); $this-line();//文字下  $this-text(); $this-line();//文字上  $this-pix(); $this-show(); return $this-rescode; } //绘制画布  private function bg() { $img = imageCreateTrueColor($this-width, $this-height); $this-imgsource = $img; imagefill( $img, 0, 0, imageColorAllocate($img, 120, 120, 120) ); } //绘制随机线条  private function line() { for ($i = 0; $i  3; $i++) { imagesetthickness($this-imgsource, mt_rand(1, 3)); imageLine( $this-imgsource, mt_rand(0, $this-width), mt_rand(0, $this-height), mt_rand(0, $this-width), mt_rand(0, $this-height), $this-ran_color() ); } } //绘制干扰点  private function pix() { for ($i = 0; $i  800; $i++) { imagesetpixel( $this-imgsource, mt_rand(0, $this-width), mt_rand(0, $this-height), $this-ran_color() ); } } //随机文本  private function text() { $range = \"abcdefghijklmnopqrstuvwxyz0123456789\"; $code = ''; for ($i = 0; $i  $this-len; $i++) { $text = $range[mt_rand(0, strlen($range) - 1)]; $box = imagettfbbox($this-size, 0, $this-fontfile, $range[$i]); imagettftext( $this-imgsource, $this-size, mt_rand(-30, 30), ($this-width / $this-len) * $i + 10, $this-height / 2 + ($box[0] - $box[7]) / 2, $this-ran_text_color(), $this-fontfile, strtoupper($text) ); $code .= strtoupper($text); } $this-rescode = $code; } //设置头信息并且输出png  private function show() { header('Content-type:image/png'); imagepng($this-imgsource); } private function ran_color() { return imageColorAllocate( $this-imgsource, mt_rand(0, 255), mt_rand(0, 255), mt_rand(0, 255), ); } private function ran_text_color() { return imageColorAllocate( $this-imgsource, mt_rand(0, 80), mt_rand(0, 80), mt_rand(0, 80), ); } }   说明：\n 如果不设置参数，默认图片尺寸为200×50，验证码长度为4，字体为 (0.4*图片高度) 通过计算使得文本始终处在垂直居中，水平分散对齐的状态  后端使用 ⚡server.php\n1 2 3 4 5 6 7 8  php //引入渲染验证码图片，并将这次返回的验证码存到session中 include \"Verificationcode.php\"; session_start();//session开始之前不能有输出 $code = new Verificationcode(); $res = $code-render(); $_SESSION[\"captcha\"]=$res; imageDestroy($code-imgsource);   说明：\n 调用render()函数，即可绘制出验证码图片，并返回这次的验证码字符串。 通过将返回的验证码字符串存入session中，可以进行后续验证操作  前端使用 1  img src=\"server.php\" alt=\"\" onclick=\"this.src='server.php?'+Math.random()\"   ✨ 可以将整个form表单提交至php后端，然后通过session中存储的验证码字符串进行验证，例如\n1 2 3 4 5 6 7 8 9 10  form action=\"check.php\" method=\"post\" enctype=\"multipart/form-data\" table tr tdinput type=\"text\" placeholder=\"请输入验证码\" name=\"captcha\" tdimg src=\"server.php\" alt=\"\" onclick=\"this.src='server.php?'+Math.random()\" td tr table button确定button form   ⚡check.php\n1 2 3 4 5 6 7 8  php session_start(); include \"main.html\"; if (@strtoupper($_POST[\"captcha\"])==@$_SESSION[\"captcha\"]){ echo \"验证通过\n\"; }else{ echo \"验证失败！\n\"; }   🎉🎉🎉\n",
  "wordCount" : "636",
  "inLanguage": "en",
  "datePublished": "2020-10-03T00:00:00Z",
  "dateModified": "2020-10-03T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Archai"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.fintinger.site/p/php%E5%BC%80%E5%8F%91%E9%AA%8C%E8%AF%81%E7%A0%81%E7%B1%BB/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Archai's home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gitee.com/fintinger/figure-bed/raw/master//images/20210530080206.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
        document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.fintinger.site" accesskey="h" title="🛖Home (Alt + H)">🛖Home</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.fintinger.site/posts/" title="Posts📑">
                    <span>Posts📑</span>
                </a>
            </li>
            <li>
                <a href="https://www.fintinger.site/categories/" title="Categories🛒">
                    <span>Categories🛒</span>
                </a>
            </li>
            <li>
                <a href="https://www.fintinger.site/search/" title="Search🔎 (Alt &#43; /)" accesskey=/>
                    <span>Search🔎</span>
                </a>
            </li>
            <li>
                <a href="https://www.fintinger.site/archives/" title="Timeline🕰️">
                    <span>Timeline🕰️</span>
                </a>
            </li>
            <li>
                <a href="https://www.fintinger.site/about/" title="About🥳">
                    <span>About🥳</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.fintinger.site">Home</a>&nbsp;»&nbsp;<a href="https://www.fintinger.site/posts/">Posts</a></div>
    <h1 class="post-title">
      PHP开发验证码类
    </h1>
    <div class="post-meta"><span title='2020-10-03 00:00:00 +0000 UTC'>October 3, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Archai

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#php%e5%88%9b%e5%bb%ba%e5%9b%be%e5%83%8f%e6%ad%a5%e9%aa%a4" aria-label="PHP创建图像步骤">PHP创建图像步骤</a><ul>
                        
                <li>
                    <a href="#%e5%8f%91%e9%80%81http%e5%a4%b4%e4%bf%a1%e6%81%af%e5%a3%b0%e6%98%8e%e5%86%85%e5%ae%b9%e4%b8%ba%e5%9b%be%e5%83%8f" aria-label="发送HTTP头信息，声明内容为图像">发送HTTP头信息，声明内容为图像</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e7%94%bb%e5%b8%83" aria-label="创建画布">创建画布</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e7%bb%98%e5%9b%be%e6%89%80%e9%9c%80%e8%a6%81%e7%9a%84%e9%a2%9c%e8%89%b2" aria-label="创建绘图所需要的颜色">创建绘图所需要的颜色</a></li>
                <li>
                    <a href="#%e7%bb%98%e5%9b%be%e5%a1%ab%e5%85%85%e7%94%bb%e5%b8%83%e7%94%bb%e5%9c%86%e7%94%bb%e6%96%b9%e5%9d%97%e7%94%bb%e7%ba%bf%e6%9d%a1%e7%94%bb%e5%b8%83%e4%b8%8a%e5%86%99%e5%ad%97" aria-label="绘图（填充画布、画圆、画方块、画线条、画布上写字）">绘图（填充画布、画圆、画方块、画线条、画布上写字）</a></li>
                <li>
                    <a href="#%e8%be%93%e5%87%ba%e5%9b%be%e5%83%8f" aria-label="输出图像">输出图像</a></li>
                <li>
                    <a href="#%e9%87%8a%e6%94%be%e7%94%bb%e5%b8%83%e8%b5%84%e6%ba%90" aria-label="释放画布资源">释放画布资源</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e7%b1%bb" aria-label="验证码类">验证码类</a><ul>
                        
                <li>
                    <a href="#verificationcode%e7%b1%bb" aria-label="Verificationcode类">Verificationcode类</a></li>
                <li>
                    <a href="#%e5%90%8e%e7%ab%af%e4%bd%bf%e7%94%a8" aria-label="后端使用">后端使用</a></li>
                <li>
                    <a href="#%e5%89%8d%e7%ab%af%e4%bd%bf%e7%94%a8" aria-label="前端使用">前端使用</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>利用php中的GD库可以完成验证码类的开发。<a href="https://houdunren.gitee.io/note/php/9%20%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86.html#%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86">后盾人教程</a></p>
</blockquote>
<h2 id="php创建图像步骤">PHP创建图像步骤<a hidden class="anchor" aria-hidden="true" href="#php创建图像步骤">#</a></h2>
<h3 id="发送http头信息声明内容为图像">发送HTTP头信息，声明内容为图像<a hidden class="anchor" aria-hidden="true" href="#发送http头信息声明内容为图像">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type:image/gif&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type:image/jpeg&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type:image/png&#39;</span>);
</code></pre></td></tr></table>
</div>
</div><p>通过设置头信息让浏览器渲染出图像，而不是HTML等其他类型</p>
<h3 id="创建画布">创建画布<a hidden class="anchor" aria-hidden="true" href="#创建画布">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imageCreateTrueColor</span>(<span style="color:#a6e22e">width</span>,<span style="color:#a6e22e">height</span>);
</code></pre></td></tr></table>
</div>
</div><p><code>width &amp; height</code> 画布宽高，即为输出图片的尺寸,返回为<code>source</code> 类型，后续操作都是针对这个资源展开。</p>
<h3 id="创建绘图所需要的颜色">创建绘图所需要的颜色<a hidden class="anchor" aria-hidden="true" href="#创建绘图所需要的颜色">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imageColorAllocate</span>(<span style="color:#a6e22e">img_resource</span>,<span style="color:#a6e22e">R</span>,<span style="color:#a6e22e">G</span>,<span style="color:#a6e22e">B</span>);
</code></pre></td></tr></table>
</div>
</div><p>颜色从属于创建画布产生的图像资源而存在，后面三个值分别为红绿蓝三个通道的值，为<code>int</code>类型,在0—255之间。</p>
<h3 id="绘图填充画布画圆画方块画线条画布上写字">绘图（填充画布、画圆、画方块、画线条、画布上写字）<a hidden class="anchor" aria-hidden="true" href="#绘图填充画布画圆画方块画线条画布上写字">#</a></h3>
<p>👉 <strong>填充画布(画布背景)</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imageFill</span>(<span style="color:#a6e22e">img_resource</span>,<span style="color:#a6e22e">x</span>,<span style="color:#a6e22e">y</span>,<span style="color:#a6e22e">color</span>);
</code></pre></td></tr></table>
</div>
</div><p>👉 <strong>画圆</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">//绘制空心圆形
</span><span style="color:#75715e"></span><span style="color:#a6e22e">imageEllipse</span>(<span style="color:#a6e22e">img_res</span>,<span style="color:#a6e22e">x</span>,<span style="color:#a6e22e">y</span>,<span style="color:#a6e22e">w</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">color</span>);
<span style="color:#75715e">//绘制填充好的实心圆
</span><span style="color:#75715e"></span><span style="color:#a6e22e">imageFilledEllipse</span>(<span style="color:#a6e22e">img_res</span>,<span style="color:#a6e22e">x</span>,<span style="color:#a6e22e">y</span>,<span style="color:#a6e22e">w</span>,<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">color</span>);
</code></pre></td></tr></table>
</div>
</div><p>绘制 圆心(x,y) 宽 x，高 h，的圆</p>
<p>👉 <strong>画方</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">//空心矩形
</span><span style="color:#75715e"></span><span style="color:#a6e22e">imageRectangle</span>(<span style="color:#a6e22e">img_res</span>,<span style="color:#a6e22e">x1</span>,<span style="color:#a6e22e">y1</span>,<span style="color:#a6e22e">x2</span>,<span style="color:#a6e22e">y2</span>,<span style="color:#a6e22e">color</span>);
<span style="color:#75715e">//实心矩形
</span><span style="color:#75715e"></span><span style="color:#a6e22e">imageFilledRectangle</span> (<span style="color:#a6e22e">img_res</span>,<span style="color:#a6e22e">x1</span>,<span style="color:#a6e22e">y1</span>,<span style="color:#a6e22e">x2</span>,<span style="color:#a6e22e">y2</span>,<span style="color:#a6e22e">color</span>);
</code></pre></td></tr></table>
</div>
</div><p>(x1,y1)为左上角坐标， (x2,y2)为右下角坐标</p>
<p><img loading="lazy" src="https://gitee.com/fintinger/figure-bed/raw/master//images/20201003214907.gif" alt="绘制矩形图示"  />
</p>
<p>👉<strong>画线条</strong></p>
<pre tabindex="0"><code>imageLine(img_res,x1,y1,x2,y2,color)
</code></pre><p>(x1,y1)与(x2,y2)两点确定的直线。</p>
<p>👉 <strong>绘制像素(点)</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imagesetpixel</span> ( <span style="color:#a6e22e">img_res</span> , <span style="color:#a6e22e">x</span> , <span style="color:#a6e22e">y</span> , <span style="color:#a6e22e">color</span> )
</code></pre></td></tr></table>
</div>
</div><p>👉 <strong>输入文本</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imagettftext</span> (<span style="color:#a6e22e">img_res</span> , <span style="color:#a6e22e">size</span> , <span style="color:#a6e22e">angle</span> , <span style="color:#a6e22e">x</span> , <span style="color:#a6e22e">y</span> , <span style="color:#a6e22e">color</span> , <span style="color:#a6e22e">fontfile</span> ,<span style="color:#a6e22e">text</span> )
</code></pre></td></tr></table>
</div>
</div><p>图像资源，字体尺寸，角度，第一个字符的基本点（大概是字符的左下角），Y 坐标（字体基线的位置），颜色 ，字体文件绝对路径(<code>realpath($path)</code>获取)，文本字符串（UTF-8 编码）</p>
<blockquote>
<p>✨<strong>文本盒子？</strong></p>
</blockquote>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imagettfbbox</span> ( <span style="color:#a6e22e">size</span> , <span style="color:#a6e22e">angle</span> , <span style="color:#a6e22e">fontfile</span> , <span style="color:#a6e22e">text</span> );
</code></pre></td></tr></table>
</div>
</div><p>返回一个含有 8 个单元的数组表示了文本外框的四个角，得到文本范围的盒子大小，可以方便控制文本输出位置：</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>位置</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>左下角 X 位置</td>
</tr>
<tr>
<td>1</td>
<td>左下角 Y 位置</td>
</tr>
<tr>
<td>2</td>
<td>右下角 X 位置</td>
</tr>
<tr>
<td>3</td>
<td>右下角 Y 位置</td>
</tr>
<tr>
<td>4</td>
<td>右上角 X 位置</td>
</tr>
<tr>
<td>5</td>
<td>右上角 Y 位置</td>
</tr>
<tr>
<td>6</td>
<td>左上角 X 位置</td>
</tr>
<tr>
<td>7</td>
<td>左上角 Y 位置</td>
</tr>
</tbody>
</table>
<h3 id="输出图像">输出图像<a hidden class="anchor" aria-hidden="true" href="#输出图像">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imagegif</span>(<span style="color:#a6e22e">img_resource</span>[,<span style="color:#a6e22e">filename</span>]);
<span style="color:#a6e22e">imagejpeg</span>(<span style="color:#a6e22e">img_resource</span>[,<span style="color:#a6e22e">filename</span>]);
<span style="color:#a6e22e">imagepng</span>(<span style="color:#a6e22e">img_resource</span>[,<span style="color:#a6e22e">filename</span>]);
<span style="color:#a6e22e">imagebmp</span>(<span style="color:#a6e22e">img_resource</span>[,<span style="color:#a6e22e">filename</span>]);
</code></pre></td></tr></table>
</div>
</div><p>当设置第二个参数时表示储存文件，如果存在同名文件会覆盖</p>
<h3 id="释放画布资源">释放画布资源<a hidden class="anchor" aria-hidden="true" href="#释放画布资源">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">imageDestroy</span>(<span style="color:#a6e22e">img_resource</span>);
</code></pre></td></tr></table>
</div>
</div><p>图像输出完毕及时释放资源，把内存空间留给更需要的程序。</p>
<h2 id="验证码类">验证码类<a hidden class="anchor" aria-hidden="true" href="#验证码类">#</a></h2>
<h3 id="verificationcode类">Verificationcode类<a hidden class="anchor" aria-hidden="true" href="#verificationcode类">#</a></h3>
<blockquote>
<p>绘制画布，设置背景色，先写入随机文本，然后绘制随机干扰线，干扰点就可</p>
</blockquote>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Verificationcode</span>
{

    <span style="color:#66d9ef">protected</span> $width;

    <span style="color:#66d9ef">protected</span> $height;

    <span style="color:#66d9ef">protected</span> $len;

    <span style="color:#66d9ef">public</span> $imgsource;

    <span style="color:#66d9ef">protected</span> $size;

    <span style="color:#66d9ef">protected</span> $fontfile;

    <span style="color:#66d9ef">protected</span> $rescode;

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct($w <span style="color:#f92672">=</span> <span style="color:#ae81ff">200</span>, $h <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>, $len <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, $size <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>)
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> $w;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span> <span style="color:#f92672">=</span> $h;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">len</span> <span style="color:#f92672">=</span> $len;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">is_null</span>($size) <span style="color:#f92672">?</span> $h <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.4</span> <span style="color:#f92672">:</span> $size;
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fontfile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">realpath</span>(<span style="color:#e6db74">&#34;source.ttf&#34;</span>);
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">render</span>()
    {
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">bg</span>();
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">line</span>();<span style="color:#75715e">//文字下
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">text</span>();
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">line</span>();<span style="color:#75715e">//文字上
</span><span style="color:#75715e"></span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">pix</span>();
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">show</span>();

        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rescode</span>;
    }

    <span style="color:#75715e">//绘制画布
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">bg</span>()
    {
        $img <span style="color:#f92672">=</span> <span style="color:#a6e22e">imageCreateTrueColor</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span>);
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span> <span style="color:#f92672">=</span> $img;
        <span style="color:#a6e22e">imagefill</span>(
            $img,
            <span style="color:#ae81ff">0</span>,
            <span style="color:#ae81ff">0</span>,
            <span style="color:#a6e22e">imageColorAllocate</span>($img, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">120</span>)
        );
    }

    <span style="color:#75715e">//绘制随机线条
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">line</span>()
    {
        <span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; $i<span style="color:#f92672">++</span>) {
            <span style="color:#a6e22e">imagesetthickness</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>, <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>));
            <span style="color:#a6e22e">imageLine</span>(
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>,
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span>),
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span>),
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span>),
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span>),
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ran_color</span>()
            );
        }
    }

    <span style="color:#75715e">//绘制干扰点
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">pix</span>()
    {
        <span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">800</span>; $i<span style="color:#f92672">++</span>) {
            <span style="color:#a6e22e">imagesetpixel</span>(
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>,
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span>),
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span>),
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ran_color</span>()
            );
        }
    }

    <span style="color:#75715e">//随机文本
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">text</span>()
    {
        $range <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz0123456789&#34;</span>;
        $code <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
        <span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">&lt;</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">len</span>; $i<span style="color:#f92672">++</span>) {
            $text <span style="color:#f92672">=</span> $range[<span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">strlen</span>($range) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)];
            $box <span style="color:#f92672">=</span> <span style="color:#a6e22e">imagettfbbox</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">size</span>, <span style="color:#ae81ff">0</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fontfile</span>, $range[$i]);
            <span style="color:#a6e22e">imagettftext</span>(
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>,
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">size</span>,
                <span style="color:#a6e22e">mt_rand</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>),
                ($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">width</span> <span style="color:#f92672">/</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">len</span>) <span style="color:#f92672">*</span> $i <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>,
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">height</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> ($box[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> $box[<span style="color:#ae81ff">7</span>]) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>,
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ran_text_color</span>(),
                $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fontfile</span>,
                <span style="color:#a6e22e">strtoupper</span>($text)
            );
            $code <span style="color:#f92672">.=</span> <span style="color:#a6e22e">strtoupper</span>($text);
        }
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rescode</span> <span style="color:#f92672">=</span> $code;
    }

    <span style="color:#75715e">//设置头信息并且输出png
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show</span>()
    {
        <span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-type:image/png&#39;</span>);
        <span style="color:#a6e22e">imagepng</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>);
    }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ran_color</span>()
    {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">imageColorAllocate</span>(
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>,
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>),
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>),
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>),
        );
    }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ran_text_color</span>()
    {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">imageColorAllocate</span>(
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>,
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">80</span>),
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">80</span>),
            <span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">80</span>),
        );
    }

}
</code></pre></td></tr></table>
</div>
</div><p><strong>说明：</strong></p>
<ul>
<li>如果不设置参数，默认图片尺寸为200×50，验证码长度为4，字体为 (0.4*图片高度)</li>
<li>通过计算使得文本始终处在垂直居中，水平分散对齐的状态</li>
</ul>
<h3 id="后端使用">后端使用<a hidden class="anchor" aria-hidden="true" href="#后端使用">#</a></h3>
<p>⚡<code>server.php</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#75715e">//引入渲染验证码图片，并将这次返回的验证码存到session中
</span><span style="color:#75715e"></span><span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#34;Verificationcode.php&#34;</span>;
<span style="color:#a6e22e">session_start</span>();<span style="color:#75715e">//session开始之前不能有输出
</span><span style="color:#75715e"></span>$code <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Verificationcode</span>();
$res <span style="color:#f92672">=</span> $code<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">render</span>();
$_SESSION[<span style="color:#e6db74">&#34;captcha&#34;</span>]<span style="color:#f92672">=</span>$res;
<span style="color:#a6e22e">imageDestroy</span>($code<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">imgsource</span>);
</code></pre></td></tr></table>
</div>
</div><p><strong>说明：</strong></p>
<ul>
<li>调用<code>render()</code>函数，即可绘制出验证码图片，并返回这次的验证码字符串。</li>
<li>通过将返回的验证码字符串存入session中，可以进行后续验证操作</li>
</ul>
<h3 id="前端使用">前端使用<a hidden class="anchor" aria-hidden="true" href="#前端使用">#</a></h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;server.php&#34;</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;this.src=&#39;server.php?&#39;+Math.random()&#34;</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>✨ 可以将整个form表单提交至php后端，然后通过session中存储的验证码字符串进行验证，例如</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;check.php&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span> <span style="color:#a6e22e">enctype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;multipart/form-data&#34;</span>&gt;
    &lt;<span style="color:#f92672">table</span>&gt;
        &lt;<span style="color:#f92672">tr</span>&gt;
            &lt;<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;请输入验证码&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;captcha&#34;</span>&gt;
            &lt;<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;server.php&#34;</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;this.src=&#39;server.php?&#39;+Math.random()&#34;</span>&gt;
            &lt;/<span style="color:#f92672">td</span>&gt;
        &lt;/<span style="color:#f92672">tr</span>&gt;
    &lt;/<span style="color:#f92672">table</span>&gt;
    &lt;<span style="color:#f92672">button</span>&gt;确定&lt;/<span style="color:#f92672">button</span>&gt;
&lt;/<span style="color:#f92672">form</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>⚡<code>check.php</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#a6e22e">session_start</span>();
<span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#34;main.html&#34;</span>;
<span style="color:#66d9ef">if</span> (<span style="color:#f92672">@</span><span style="color:#a6e22e">strtoupper</span>($_POST[<span style="color:#e6db74">&#34;captcha&#34;</span>])<span style="color:#f92672">==@</span>$_SESSION[<span style="color:#e6db74">&#34;captcha&#34;</span>]){
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;p style=&#39;color: #4FEF10&#39;&gt;验证通过&lt;/p&gt;&#34;</span>;
}<span style="color:#66d9ef">else</span>{
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;p style=&#39;color: #e01&#39;&gt;验证失败！&lt;/p&gt;&#34;</span>;
}
</code></pre></td></tr></table>
</div>
</div><p>🎉🎉🎉</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.fintinger.site/tags/php/">PHP</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.fintinger.site/p/ds%E5%AF%BC%E8%AE%BA/">
    <span class="title">« Prev Page</span>
    <br>
    <span>DS导论</span>
  </a>
  <a class="next" href="https://www.fintinger.site/p/git%E7%9B%B8%E5%85%B3/">
    <span class="title">Next Page »</span>
    <br>
    <span>Git相关</span>
  </a>
</nav>

  </footer><script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
    .waline-container .vcount {
        color: var(--card-text-color-main);
    }
</style><script>
    
    new Waline({"avatar":"robohash","dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tieba","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji"],"highlight":true,"locale":{"admin":"Admin"},"placeholder":"说点什么༼ つ ◕_◕ ༽つ","requiredMeta":["name","email","url"],"serverURL":"https://waline-q3l7of5hj-fintinger.vercel.app/","visitor":true});
</script>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://www.fintinger.site">Archai&#39;s home</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
